---
container: Post
title: Base64
date: 2021/9/15
---

> [Base64](https://en.wikipedia.org/wiki/Base64)，本篇文章将介绍其实现原理

Base64 是基于 64 个可打印字符（可理解为常用字符，各平台都可以安全传输的字符）来表示二进制数据的编解码方式，这是基本字符集图：

<img src="/imgs/en.wikipedia.org_wiki_Base64.png" style="width: 60%;" />

通过将字符集外的所有符号都转换成这个字符集中的字符来实现编码，具体如下：

1. 将每 3 个字节作为一组，一共是 24 个二进制位；
2. 将这 24 个二进制位重组为 4 组，这样每组有 6 个二进制位；
3. 将重组的后的每组前面补位两个 0 来达到每组 8 位的标准（若依然不足 8 位，则在后面补 0），这样这重组后的 4 组扩展成了 32 个二进制位，即 4 个字节；
4. 将每个字节的值根据上表查出对应的字符。

可以看出，Base64 将 3 个字节转化为 4 个字节，因此 Base64 编码后的文本会比原文本大出三分之一左右。

**一个将英文单词 Man 转换成 Base64 编码后的例子：**

1. 'M'、 'a'、 'n' 的 ASCII（或 Unicode） 的值分别是 77、97、110，对应的二进制分别是：01001101、01100001、01101110，将它们连成一个 24 位的二进制字符串 010011010110000101101110；

2. 将这个 24 位的二进制字符串分成 4 组，每组 6 个二进制位：010011、010110、000101、101110；

3. 在每组前面加两个 00，扩展成 32 个二进制位，即 4 个字节：00010011、00010110、00000101、00101110。它们的十进制值分别是19、22、5、46；

4. 根据上表，得到每个值对应 Base64 编码，即 T、W、F、u。

即 Man 的 Base64 编码就是 TWFu。

**一个将英文单词 Ma 转换成 Base64 编码后的例子，这个例子将展示待编码的字节数不是 3 的倍数情况：**

1. 'M'、 'a' 的 ASCII（或 Unicode） 的值分别是 77、97，对应的二进制分别是：01001101、01100001，将它们连成一个 24 位的二进制字符串 0100110101100001；

2. 将这个 24 位的二进制字符串分成 4 组，每组 6 个二进制位：010011、010110、0001；

3. 将每组的前后补 0 来达到每组 8 个二进制位的标准：00010011、00010110、00000100

4. 根据上表，得到每个值对应 Base64 编码，即 T、W、F，但缺少一个字节（一共需要 4 个字节），因此再补上一个（缺 2 个则补 2 个，最大情况缺 2 个） “=” 字符

即 Ma 的 Base64 编码就是 TWF=。

**中文编码 Base64 情况：**

因 Base64 是对字节进行重组，如果对中文字符串进行 Base64 编码，和结果有关的是中文字符串使用的编码，如 UTF-8、UTF-16、GBK 等编码的结果都不相同，因此对 Base64 字符串解码完后还需要使用相同的中文字符串解析出源字符串。
